knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list("latex")
default(kable_styling)  <- list(latex_options = c("hold_position", "striped"))
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 90, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#B85231", size=10, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#F5E8E4", size=1, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-14"), by = 1))
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none')+
scale_color_brewer(palette = "OrRd")
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
+theme_bw()+theme()
# processing
library(readxl)
library(tidyverse)
library(janitor)
# timeseries
library(zoo)
# math
library(forecast)
# graphs
library(ggplot2)
# formatting
library(default)
library(knitr)
library(kableExtra)
# Set default augments for code chunks
knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list("latex")
default(kable_styling)  <- list(latex_options = c("hold_position", "striped"))
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 90, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#B85231", size=10, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#F5E8E4", size=1, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-14"), by = 1))
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none')+
scale_color_brewer(palette = "OrRd")
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
theme_bw()+theme()
p2<-ggAcf(ATM1)+ labs(title="Acf: ATM1")+
theme_bw()+theme()
p3<-ggPacf(ATM1)+ labs(title="Pacf: ATM1")+
theme_bw()+theme()
p4<-autoplot(ATM1d)+ labs(title="Series: diff(ATM1)")+
theme_bw()+theme()
p5<-ggAcf(ATM1d)+ labs(title="Acf: diff(ATM1)")+
theme_bw()+theme()
p6<-ggPacf(ATM1d)+ labs(title="Pacf: diff(ATM1)")+
theme_bw()+theme()
grid.arrange(grob=p1, p4, p2, p5, p3, p6,
ncol=2,
top=textGrob("Daily ATM Transactions for ATM1",
gp = gpar(fontface = "bold", cex = 1)))
# processing
library(readxl)
library(tidyverse)
library(janitor)
# timeseries
library(zoo)
# math
library(forecast)
# graphs
library(ggplot2)
library(gridExtra)
# formatting
library(default)
library(knitr)
library(kableExtra)
# processing
library(readxl)
library(tidyverse)
library(janitor)
# timeseries
library(zoo)
# math
library(forecast)
# graphs
library(ggplot2)
library(gridExtra)
# formatting
library(default)
library(knitr)
library(kableExtra)
# Set default augments for code chunks
knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list("latex")
default(kable_styling)  <- list(latex_options = c("hold_position", "striped"))
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 90, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#B85231", size=10, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#F5E8E4", size=1, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-14"), by = 1))
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none')+
scale_color_brewer(palette = "OrRd")
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
theme_bw()+theme()
p2<-ggAcf(ATM1)+ labs(title="Acf: ATM1")+
theme_bw()+theme()
p3<-ggPacf(ATM1)+ labs(title="Pacf: ATM1")+
theme_bw()+theme()
p4<-autoplot(ATM1d)+ labs(title="Series: diff(ATM1)")+
theme_bw()+theme()
p5<-ggAcf(ATM1d)+ labs(title="Acf: diff(ATM1)")+
theme_bw()+theme()
p6<-ggPacf(ATM1d)+ labs(title="Pacf: diff(ATM1)")+
theme_bw()+theme()
grid.arrange(grob=p1, p4, p2, p5, p3, p6,
ncol=2,
top=textGrob("Daily ATM Transactions for ATM1",
gp = gpar(fontface = "bold", cex = 1)))
# processing
library(readxl)
library(tidyverse)
library(janitor)
# timeseries
library(zoo)
# math
library(forecast)
# graphs
library(ggplot2)
library(grid)
library(gridExtra)
# formatting
library(default)
library(knitr)
library(kableExtra)
# Set default augments for code chunks
knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list("latex")
default(kable_styling)  <- list(latex_options = c("hold_position", "striped"))
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 90, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#B85231", size=10, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#F5E8E4", size=1, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-14"), by = 1))
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none')+
scale_color_brewer(palette = "OrRd")
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
theme_bw()+theme()
p2<-ggAcf(ATM1)+ labs(title="Acf: ATM1")+
theme_bw()+theme()
p3<-ggPacf(ATM1)+ labs(title="Pacf: ATM1")+
theme_bw()+theme()
p4<-autoplot(ATM1d)+ labs(title="Series: diff(ATM1)")+
theme_bw()+theme()
p5<-ggAcf(ATM1d)+ labs(title="Acf: diff(ATM1)")+
theme_bw()+theme()
p6<-ggPacf(ATM1d)+ labs(title="Pacf: diff(ATM1)")+
theme_bw()+theme()
grid.arrange(grob=p1, p4, p2, p5, p3, p6,
ncol=2,
top=textGrob("Daily ATM Transactions for ATM1",
gp = gpar(fontface = "bold", cex = 1)))
ATM1 %>% diff() %>% ur.kpss() %>% summary()
# processing
library(readxl)
library(tidyverse)
library(janitor)
# timeseries
library(zoo)
# math
library(forecast)
library(urca)
# graphs
library(ggplot2)
library(grid)
library(gridExtra)
# formatting
library(default)
library(knitr)
library(kableExtra)
# Set default augments for code chunks
knitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list("latex")
default(kable_styling)  <- list(latex_options = c("hold_position", "striped"))
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 90, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#B85231", size=10, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#F5E8E4", size=1, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-14"), by = 1))
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none')+
scale_color_brewer(palette = "OrRd")
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
theme_bw()+theme()
p2<-ggAcf(ATM1)+ labs(title="Acf: ATM1")+
theme_bw()+theme()
p3<-ggPacf(ATM1)+ labs(title="Pacf: ATM1")+
theme_bw()+theme()
p4<-autoplot(ATM1d)+ labs(title="Series: diff(ATM1)")+
theme_bw()+theme()
p5<-ggAcf(ATM1d)+ labs(title="Acf: diff(ATM1)")+
theme_bw()+theme()
p6<-ggPacf(ATM1d)+ labs(title="Pacf: diff(ATM1)")+
theme_bw()+theme()
grid.arrange(grob=p1, p4, p2, p5, p3, p6,
ncol=2,
top=textGrob("Daily ATM Transactions for ATM1",
gp = gpar(fontface = "bold", cex = 1)))
# root test using urca package
ATM1 %>% diff() %>% ur.kpss() %>% summary()
ATM1d %>% diff() %>% ur.kpss() %>% summary()
#subset data
ATM2 <- atm_ts[,2]
p1<-autoplot(ATM2)+ labs(title="Series: ATM2")+ theme_bw()+theme()
p2<-ggAcf(ATM2)+ labs(title="Acf: ATM2")+ theme_bw()+theme()
p3<-ggPacf(ATM2)+ labs(title="Pacf: ATM2")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM2",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM3 <- atm_ts[,3]
p1<-autoplot(ATM3)+ labs(title="Series: ATM3")+ theme_bw()+theme()
p2<-ggAcf(ATM3)+ labs(title="Acf: ATM3")+ theme_bw()+theme()
p3<-ggPacf(ATM3)+ labs(title="Pacf: ATM3")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM3",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM4 <- atm_ts[,4]
p1<-autoplot(ATM4)+ labs(title="Series: ATM4")+ theme_bw()+theme()
p2<-ggAcf(ATM4)+ labs(title="Acf: ATM4")+ theme_bw()+theme()
p3<-ggPacf(ATM4)+ labs(title="Pacf: ATM4")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM4",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM1 <- atm_ts[,1]
#differentiated
ATM1d <-  diff(ATM1)
p1<-autoplot(ATM1)+ labs(title="Series: ATM1")+
theme_bw()+theme()
p2<-ggAcf(ATM1)+ labs(title="Acf: ATM1")+
theme_bw()+theme()
p3<-ggPacf(ATM1)+ labs(title="Pacf: ATM1")+
theme_bw()+theme()
p4<-autoplot(ATM1d)+ labs(title="Series: diff(ATM1)")+
theme_bw()+theme()
p5<-ggAcf(ATM1d)+ labs(title="Acf: diff(ATM1)")+
theme_bw()+theme()
p6<-ggPacf(ATM1d)+ labs(title="Pacf: diff(ATM1)")+
theme_bw()+theme()
grid.arrange(grob=p1, p4, p2, p5, p3, p6,
ncol=2,
top=textGrob("Daily ATM Transactions for ATM1",
gp = gpar(fontface = "bold", cex = 1)))
# root test using urca package
ATM1 %>% diff() %>% ur.kpss() %>% summary()
ATM1d %>% diff() %>% ur.kpss() %>% summary()
#subset data
ATM2 <- atm_ts[,2]
p1<-autoplot(ATM2)+ labs(title="Series: ATM2")+ theme_bw()+theme()
p2<-ggAcf(ATM2)+ labs(title="Acf: ATM2")+ theme_bw()+theme()
p3<-ggPacf(ATM2)+ labs(title="Pacf: ATM2")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM2",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM3 <- atm_ts[,3]
p1<-autoplot(ATM3)+ labs(title="Series: ATM3")+ theme_bw()+theme()
p2<-ggAcf(ATM3)+ labs(title="Acf: ATM3")+ theme_bw()+theme()
p3<-ggPacf(ATM3)+ labs(title="Pacf: ATM3")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM3",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM4 <- atm_ts[,4]
p1<-autoplot(ATM4)+ labs(title="Series: ATM4")+ theme_bw()+theme()
p2<-ggAcf(ATM4)+ labs(title="Acf: ATM4")+ theme_bw()+theme()
p3<-ggPacf(ATM4)+ labs(title="Pacf: ATM4")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM4",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
#subset data
ATM4 <- atm_ts[,4]
p1<-autoplot(ATM4)+ labs(title="Series: ATM4")+ theme_bw()+theme()
p2<-ggAcf(ATM4)+ labs(title="Acf: ATM4")+ theme_bw()+theme()
p3<-ggPacf(ATM4)+ labs(title="Pacf: ATM4")+ theme_bw()+theme()
grid.arrange(grob=p1, p2, p3,
layout_matrix = rbind(c(1,1),c(2,3)),
top=textGrob("Daily ATM Transactions for ATM4",
gp = gpar(fontface = "bold", cex = 1, col = "#233c49")))
