p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
checkresiduals(ATM1_arima)
ggAcf(ATM1_arima$fitted)
summary(ATM1_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
checkresiduals(ATM1_arima)
ggAcf(ATM1_arima$x)
summary(ATM1_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-checkresiduals(ATM1_arima)
p2<-checkresiduals(ATM2_arima)
p3<-checkresiduals(ATM4_arima)
grid.arrange(p1, p2, p3, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-checkresiduals(ATM1_arima, lag=7)
p1<-ggAcf(ATM1_arima$residuals, lag=7)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-checkresiduals(ATM1_arima, lag=7)
p1<-ggAcf(ATM1_arima$residuals, lag=21)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-checkresiduals(ATM1_arima, lag=7)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
checkresiduals(ATM1_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
summary(ATM1_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
summary(ATM2_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
summary(ATM4_arima)
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(3,0,2)")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(1,0,4)")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(2,0,3)")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(0,1,2)(0,2,1)[7]")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(0,1,3)(0,2,1)[7]")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(0,1,2)(0,2,1)[7]")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
ATM1_arima %>% predict(h=2)
ATM1_arima %>% predict(n.ahead=4)
ATM1_arima %>% forecast(h=4)
ATM1_arima %>% forecast(h=4, xreg=ATM1_arima$xreg)
ATM1_fc <-ATM1_arima %>% forecast(h=1, xreg=ATM1_arima$xreg)
ATM1_fc <-ATM1_arima %>% forecast(h=1, xreg=ATM1_arima$xreg)
ATM1_fc
ATM1_fc <-ATM1_arima %>% forecast( h=horizon, xreg=ATM1_arima$xreg)
ATM1_fc
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc
# General
library('easypackages')
libraries('knitr', 'kableExtra', 'default')
# Processing
libraries('readxl', 'tidyverse', 'janitor', 'lubridate')
# Graphing
libraries('ggplot2', 'grid', 'gridExtra')
# Timeseries
libraries('zoo', 'urca', 'tseries', 'timetk')
# Math
libraries('forecast')
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
# General
library('easypackages')
libraries('knitr', 'kableExtra', 'default')
# Processing
libraries('readxl', 'tidyverse', 'janitor', 'lubridate')
# Graphing
libraries('ggplot2', 'grid', 'gridExtra')
# Timeseries
libraries('zoo', 'urca', 'tseries', 'timetk')
# Math
libraries('forecast')
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
# Set default augments for code chunks
knitr::opts_chunk$set(echo = F, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list(format="latex")
default(kable_styling)  <- list(latex_options = c("HOLD_position", "striped"))
default(row_spec) <- list(row=0, bold=T)
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 0, hjust = NULL),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#4c4c4c", size=12, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#cccdd0", size=.75, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# GGplot Palette
default(scale_color_brewer) <- list(palette = 'RdPu', direction=1)
# plot atms as scatterplot
atm %>%
# re-gather observations for facet plot
gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>%
# remove NA value from ATM2
filter(complete.cases(.)) %>%
# plot
ggplot(aes(DATE, Cash, color=ATM)) +
geom_point() +
geom_smooth(method="loess") +
facet_wrap(~ATM, scales='free_x', nrow=1) +
labs(title="ATM Scatterplot")+
theme_bw()+
theme(legend.position = 'none', axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_color_brewer()
autoplot(atm_zoo)+
labs(title = "Daily ATM Transactions", subtitle = "Series: ATM1", ylab="Withdrawals (in hundreds)")+
theme_bw()+ theme()
p1<-ggAcf(ATM1_ts)+ labs(title="ACF: ATM1")+ theme_bw()+theme()
p2<-ggPacf(ATM1_ts)+ labs(title="PACF: ATM1")+ theme_bw()+ theme()
p3<-ggAcf(ATM2_ts)+ labs(title="ACF: ATM2")+ theme_bw()+theme()
p4<-ggPacf(ATM2_ts)+ labs(title="PACF: ATM2")+ theme_bw()+ theme()
p5<-ggAcf(ATM4_ts)+ labs(title="ACF: ATM4")+ theme_bw()+theme()
p6<-ggPacf(ATM4_ts)+ labs(title="PACF: ATM4")+ theme_bw()+ theme()
grid.arrange(grob=p1, p3, p5, p2, p4, p6, ncol=3)
urATM1<-cbind("ATM"="ATM1", "No-Diff"=round(ATM1_ur@teststat,4),"Diff-1" =round(ATM1d_ur@teststat,4),"Log-Diff-1" =round(ATM1sd_ur@teststat,4),"Log-Diff-2" =round(ATM1sdd_ur@teststat,4))
urATM2<-cbind("ATM"="ATM2", "No-Diff"=round(ATM2_ur@teststat,4),"Diff-1" =round(ATM2d_ur@teststat,4),"Log-Diff-1" =round(ATM2sd_ur@teststat,4),"Log-Diff-2" =round(ATM2sdd_ur@teststat,4))
urATM4<-cbind("ATM"="ATM4", "No-Diff"=round(ATM4_ur@teststat,4),"Diff-1" =round(ATM4d_ur@teststat,4),"Log-Diff-1" =round(ATM4sd_ur@teststat,4),"Log-Diff-2" =round(ATM4sdd_ur@teststat,4))
rbind(urATM1, urATM2,urATM4) %>% kable(caption="KPSS unit root test") %>% kable_styling() %>% row_spec()
p1<-ggAcf(ATM1_arima$residuals)+ labs(title="ATM1", x="Lag") +theme_bw()+theme()
p2<- gghistogram(ATM1_arima$residuals, add.normal = T)+
labs(title="ATM1", subtitle="ARIMA(0,1,2)(0,2,1)[7]")+
theme_bw()+theme()
p3<-ggAcf(ATM2_arima$residuals)+ labs(title="ATM2",x="Lag") +theme_bw()+theme()
p4<-gghistogram(ATM2_arima$residuals, add.normal = T)+
labs(title="ATM2", subtitle="ARIMA(0,1,3)(0,2,1)[7]")+
theme_bw()+theme()
p5<-ggAcf(ATM4_arima$residuals)+ labs(title="ATM3",x="Lag") +theme_bw()+theme()
p6<-gghistogram(ATM4_arima$residuals, add.normal = T)+
labs(title="ATM4", subtitle="ARIMA(0,1,2)(0,2,1)[7]")+
theme_bw()+theme()
grid.arrange(grob=p1, p3, p5, ncol=3, top=textGrob(label="ACF Plots"))
grid.arrange(p2, p4, p6, ncol=3, top=textGrob(label="Residuals Plots"))
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc
ATM1_fc %>% autoplot()+labs(subtitle = "ATM1 Series", x="Days", y="")+theme_bw()+theme()
ATM2_fc %>% autoplot()+labs(subtitle = "ATM2 Series", x="Days", y="")+theme_bw()+theme()
ATM4_fc %>% autoplot()+labs(subtitle = "ATM4 Series", x="Days", y="")+theme_bw()+theme()
ATM1_fc %>% kable(caption="ATM1 Forecast") %>% kable_styling() %>% row_spec()
ATM2_fc %>% kable(caption="ATM2 Forecast") %>% kable_styling() %>% row_spec()
ATM4_fc %>% kable(caption="ATM4 Forecast") %>% kable_styling() %>% row_spec()
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=1,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=.5,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=.25,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_arima$aicc
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_arima$aicc
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 1, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_arima$aicc
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_arima$aicc
ATM1_fc <-ATM1_arima %>% forecast( h=4,xreg=ATM1_arima$xreg)
ATM1_fc %>% autoplot()
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM1_arima$aicc
ATM1_fc <-ATM1_arima %>% forecast(h=4,xreg=ATM1_arima$xreg)
ATM1_fc
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 3), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda, xreg = seas, method="ML")
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
# Set default augments for code chunks
knitr::opts_chunk$set(echo = F, message=F, warning=F, error=F, comment=F, fig.width=10, fig.height = 3)
# Set default augments for `kable_styling()`
default(kable) <- list(format="latex")
default(kable_styling)  <- list(latex_options = c("HOLD_position", "striped"))
default(row_spec) <- list(row=0, bold=T)
# Set default for ggplot theme
default(theme) <- list(axis.text.x = element_text(angle = 0, hjust = NULL),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(color="#4c4c4c", size=12, face="bold"),
plot.subtitle = (element_text(size=8, color="#000000")),
legend.title = (element_text(size=10, color="#000000", face="bold")),
strip.background = element_rect(color="#000000",
fill="#cccdd0", size=.75, linetype="solid"),
strip.text.x = element_text(size = 8, color = "#000000", face="bold"))
# GGplot Palette
default(scale_color_brewer) <- list(palette = 'RdPu', direction=1)
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 3), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda, xreg = seas, method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 3), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 3), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 3), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(1, 1, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 2), seasonal=list(order=c(0, 2, 2),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 3), seasonal=list(order=c(0, 2, 2),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 2), seasonal=list(order=c(0, 2, 3),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 1, 2), seasonal=list(order=c(0, 1, 2),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order =c(0, 2, 2), seasonal=list(order=c(0, 2, 2),period = 7), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_fc <-ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM2_arima %>% forecast(h=4,xreg=ATM2_arima$xreg) %>% autoplot()
ATM2_fc
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 2), seasonal=list(order=c(0, 2, 1), lambda=ATM2_lambda,  method="ML")
ATM2_arima$aicc
ATM2_arima<-Arima(ATM2_ts, order = c(0, 1, 2), seasonal=list(order=c(0, 2, 1)), lambda=ATM2_lambda,  method="ML")
ATM4_arima<-Arima(ATM4_ts, order = c(0, 1, 2), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM2_lambda,  method="ML")
ATM4_arima$aicc
ATM4_fc <-ATM4_arima %>% forecast(h=4,xreg=ATM2_arima$xreg)
ATM4_arima %>% forecast(h=4) %>% autoplot()
ATM4_fc
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
## math packages
library(urca)
# Dependencies
## processing
library(readxl)
library(tidyverse)
library(janitor)
## timeseries
library(zoo)
## math packages
library(urca)
library(forecast)
# load data
atm_data <- read_excel("data/ATM624Data.xlsx")
# clean dataframe
atm <- atm_data %>%
# create wide dataframe
spread(ATM, Cash) %>%
# remove NA column using function from janitor package
remove_empty(which = "cols") %>%
# filter unobserved values from May 2010
filter(DATE < as.Date("2010-05-01")) %>%
# ensure dates are ascending
arrange(DATE)
## remove NA
atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)
## remove outlier
atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)
# create zoo time series
atm_zoo <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
zoo(seq(from = as.Date("2009-05-01"), to = as.Date("2010-05-01"), by = 1))
# create standard time series
atm_ts <- atm %>%
# remove column & generate date in timeseries using zoo
select(-DATE) %>%
# generate ts using zoo
ts(start=1, end=365, frequency = 52)
#subset data
ATM1_zoo <- atm_zoo[,1]; ATM1_ts <- atm_ts[,1]
ATM4_zoo <- atm_zoo[,4]; ATM4_ts <- atm_ts[,4]
ATM2_zoo <- atm_zoo[,2]; ATM2_ts <- atm_ts[,2]
#unit root test
## no diff
ATM1_ur <-ur.kpss(ATM1_ts)
ATM2_ur <-ur.kpss(ATM2_ts)
ATM4_ur <-ur.kpss(ATM4_ts)
## first order diff
ATM1d_ur <-ur.kpss(diff(ATM1_ts, lag=7))
ATM2d_ur <-ur.kpss(diff(ATM2_ts, lag=7))
ATM4d_ur <-ur.kpss(diff(ATM4_ts, lag=7))
## seasonal diff
ATM1sd_ur <-ur.kpss(diff(log(ATM1_ts), lag=7))
ATM2sd_ur <-ur.kpss(diff(log(ATM2_ts), lag=7))
ATM4sd_ur <-ur.kpss(diff(log(ATM4_ts), lag=7))
## seasonal diff-diff
ATM1sdd_ur <-ur.kpss(diff(diff(log(ATM1_ts)), lag=7))
ATM2sdd_ur <-ur.kpss(diff(diff(log(ATM2_ts)), lag=7))
ATM4sdd_ur <-ur.kpss(diff(diff(log(ATM4_ts)), lag=7))
# Modeling
## Lambda for Box-cox transformation
ATM1_lambda <- BoxCox.lambda(ATM1_ts)
ATM2_lambda <- BoxCox.lambda(ATM2_ts)
ATM4_lambda <- BoxCox.lambda(ATM4_ts)
## Set terms for seasonality modeling
seas <- fourier(ATM1_ts, K=4)
## ARIMA
ATM1_arima<-Arima(ATM1_ts, order = c(1, 0, 1), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda,  method="ML")
ATM2_arima<-Arima(ATM2_ts, order =c(0, 2, 2), seasonal=list(order=c(0, 2, 2),period = 7), lambda=ATM2_lambda,  method="ML")
ATM4_arima<-Arima(ATM4_ts,  order = c(0, 1, 2), seasonal=list(order=c(0, 2, 1),period = 7), lambda=ATM1_lambda, xreg = seas, method="ML")
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
### UNIVERSAL DATA SOURCING & DEFAULT SETTINGS FOR PROJECT
# Load All Sourced Code
suppressWarnings(source("scripts/Part-A-JM.R"))
