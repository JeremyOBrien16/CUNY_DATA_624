"0","# load data "
"0","atm_data <- read_excel(""data/ATM624Data.xlsx"") "
"0","# clean dataframe"
"0","atm <- atm_data %>% "
"0","  # create wide dataframe"
"0","  spread(ATM, Cash) %>% "
"0","  # remove NA column using function from janitor package"
"0","  remove_empty(which = ""cols"") %>%"
"0","  # filter unobserved values from May 2010"
"0","  filter(DATE < as.Date(""2010-05-01"")) %>%"
"0","  # ensure dates are ascending"
"0","  arrange(DATE) "
"0","## remove NA"
"0","atm$ATM2[is.na(atm$ATM2)] <- mean(atm$ATM2, na.rm = TRUE)"
"0","## remove outlier"
"0","atm$ATM4[which.max(atm$ATM4)] <- mean(atm$ATM4, na.rm = TRUE)"
"0","# create time series   "
"0","atm_ts <- atm %>%  "
"0","  # remove column & generate date in timeseries using zoo"
"0","  select(-DATE) %>% "
"0","  # generate ts using zoo "
"0","  zoo(seq(from = as.Date(""2009-05-01""), to = as.Date(""2010-05-14""), by = 1))"
"0","# plot atms as scatterplot"
"0","atm %>% "
"0","  # re-gather observations for facet plot"
"0","  gather(key=ATM, value=Cash, ATM1,ATM2, ATM3,ATM4) %>% "
"0","  # remove NA value from ATM2"
"0","  filter(complete.cases(.)) %>% "
"0","  # plot "
"0","  ggplot(aes(DATE, Cash, color=ATM)) +"
"0","  geom_point() +"
"0","  geom_smooth(method=""loess"") +"
"0","  facet_wrap(~ATM, scales='free_x', nrow=1) +"
"0","  labs(title=""ATM Scatterplot"")+"
"0","  theme_bw()+"
"0","  theme(legend.position = 'none')+"
"0","  scale_color_brewer(palette = ""OrRd"")"
